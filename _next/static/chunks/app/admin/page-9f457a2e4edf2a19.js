(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{1690:function(e,s,n){Promise.resolve().then(n.bind(n,281))},281:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return o}});var t=n(7437),a=n(2265),r=n(2141);let l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFyeXB6aG90eGZsaW1yb3BybWRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwMDYxMTAsImV4cCI6MjA4NzU4MjExMH0.qcqFIvYRiixwu609Wjj9H3HxscU8vNpo9nS_KQ3f00A",i="".concat("https://arypzhotxflimroprmdk.supabase.co","/functions/v1/anthropic-proxy");async function c(e){try{let s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l),apikey:l},body:JSON.stringify(e)});if(!s.ok){let e=await s.text();throw console.error("Edge Function 오류:",e),Error("Anthropic API 오류 (".concat(s.status,"): ").concat(e))}return(await s.json()).content[0].text}catch(e){throw console.error("Anthropic API 호출 실패:",e),e instanceof Error?e:Error("알 수 없는 오류가 발생했습니다.")}}function d(e){let s=e.trim(),n=(s=s.replace(/^```(?:json)?\s*\n?/i,"").replace(/\n?```\s*$/i,"")).match(/\{[\s\S]*\}/);return n&&(s=n[0]),JSON.parse(s)}function o(){var e,s,n;let[l,i]=(0,a.useState)("dashboard"),[o,x]=(0,a.useState)([]),[m,u]=(0,a.useState)(!0),[h,g]=(0,a.useState)(null),[p,f]=(0,a.useState)(!1),[j,v]=(0,a.useState)(null),[y,N]=(0,a.useState)({totalSignals:0,totalVotes:0,totalReports:0,totalMemos:0,pendingReports:0,reviewedReports:0,resolvedReports:0,participationRate:0});(0,a.useEffect)(()=>{b()},[]);let b=async()=>{try{u(!0);let[e,s]=await Promise.all([(0,r.to)(),(0,r.Y9)()]);x(e),N(s)}catch(e){console.error("데이터 로딩 실패:",e)}finally{u(!1)}},w=async(e,s)=>{try{await (0,r.oP)(e,s),await b(),alert("상태가 업데이트되었습니다.")}catch(e){console.error("상태 업데이트 실패:",e),alert("상태 업데이트에 실패했습니다.")}},_=async e=>{try{var s,n;f(!0),v(e);let{data:t,error:a}=await r.OQ.from("signal_reports").select("\n          *,\n          influencer_signals (\n            id,\n            stock,\n            ticker,\n            signal,\n            key_quote,\n            timestamp,\n            reasoning,\n            influencer_videos (\n              subtitle_text,\n              title,\n              published_at\n            )\n          )\n        ").eq("id",e).single();if(a||!t)throw Error("신고 데이터를 찾을 수 없습니다.");if(!(null===(n=t.influencer_signals)||void 0===n?void 0:null===(s=n.influencer_videos)||void 0===s?void 0:s.subtitle_text))throw Error("자막 데이터가 없습니다.");let l=t.influencer_signals,i=l.influencer_videos.subtitle_text,d="\n원본 자막과 시그널을 비교해서 신고 사유가 타당한지 검토해 주세요.\n\n**원본 자막:**\n".concat(i,"\n\n**추출된 시그널:**\n- 종목: ").concat(l.stock," (").concat(l.ticker||"N/A",")\n- 신호: ").concat(l.signal,"\n- 인용문: ").concat(l.key_quote,"\n- 타임스탬프: ").concat(l.timestamp,"\n- 분석근거: ").concat(l.reasoning||"N/A","\n\n**신고 정보:**\n- 신고 사유: ").concat(t.reason,"\n- 상세 내용: ").concat(t.detail||"없음","\n\n**검토 기준:**\n1. 인용문이 실제 자막과 일치하는가?\n2. 시그널 타입이 발언 내용과 일치하는가?\n3. 타임스탬프가 정확한가?\n4. 분석근거가 합리적인가?\n\n**결과 형식:**\n상태: [수정필요/문제없음]\n근거: [구체적인 근거 설명]\n"),o=await c({model:"claude-opus-4-6",max_tokens:1e3,messages:[{role:"user",content:d}]}),{error:x}=await r.OQ.from("signal_reports").update({ai_review:o}).eq("id",e);if(x)throw Error("AI 검토 결과 저장 실패");let m=null;if(o.includes("수정필요")||o.includes("수정 필요")){let s="\n이전 검토 결과에 따라 수정된 시그널을 JSON 형태로 생성해 주세요.\n\n**원본 자막:**\n".concat(i,"\n\n**기존 시그널:**\n- 종목: ").concat(l.stock,"\n- 티커: ").concat(l.ticker,"\n- 신호: ").concat(l.signal,"\n- 인용문: ").concat(l.key_quote,"\n- 타임스탬프: ").concat(l.timestamp,"\n- 분석근거: ").concat(l.reasoning,"\n\n**검토 결과:**\n").concat(o,'\n\n**수정안을 다음 JSON 형식으로 제공해 주세요:**\n{\n  "stock": "종목명",\n  "ticker": "티커 또는 null",\n  "signal": "매수|긍정|중립|경계|매도",\n  "key_quote": "원본 자막에서 추출한 실제 발언 (15자 이상, 반드시 자막 원문 그대로)",\n  "timestamp": "MM:SS (자막에서 해당 발언이 시작되는 시점)",\n  "reasoning": "자막 내용 기반 구체적 분석근거 (20자 이상, 왜 이 시그널인지 설명)"\n}\n\n**절대 금지:**\n- key_quote를 빈 문자열("")이나 "N/A"로 채우지 마세요. 반드시 원본 자막에서 실제 발언을 정확히 복사하세요.\n- reasoning을 "N/A"나 빈 값으로 채우지 마세요. 자막의 맥락을 분석하여 구체적으로 작성하세요.\n- 원본 자막에 없는 내용을 창작하지 마세요.\n\n반드시 순수 JSON만 반환. markdown 코드블록(```)으로 감싸지 마세요.\n');try{m=await c({model:"claude-opus-4-6",max_tokens:500,messages:[{role:"user",content:s}]}),await r.OQ.from("signal_reports").update({ai_suggestion:m}).eq("id",e)}catch(e){console.error("수정안 생성 실패:",e)}}alert("AI 검토가 완료되었습니다!"),await b()}catch(e){console.error("AI 검토 실패:",e),alert(e instanceof Error?e.message:"AI 검토에 실패했습니다.")}finally{f(!1),v(null)}},k=async e=>{if(!e.ai_suggestion||!e.influencer_signals){alert("AI 수정안이 없습니다.");return}try{let s=d(e.ai_suggestion),{error:n}=await r.OQ.from("influencer_signals").update({stock:s.stock,ticker:s.ticker,signal:s.signal,key_quote:s.key_quote,timestamp:s.timestamp,reasoning:s.reasoning}).eq("id",e.influencer_signals.id);if(n)throw n;await (0,r.oP)(e.id,"resolved"),alert("AI 수정안이 승인되어 시그널이 업데이트되었습니다."),await b(),g(null)}catch(e){console.error("승인 처리 실패:",e),alert("승인 처리에 실패했습니다.")}},D=async e=>{try{await (0,r.oP)(e,"resolved"),alert("신고가 거절되었습니다."),await b(),g(null)}catch(e){console.error("거절 처리 실패:",e),alert("거절 처리에 실패했습니다.")}},S=e=>new Date(e).toLocaleDateString("ko-KR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),I=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"reviewed":return"bg-blue-100 text-blue-800";case"resolved":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},A=e=>{switch(e){case"pending":return"대기";case"reviewed":return"검토";case"resolved":return"완료";default:return e}},E=e=>{switch(e){case"매수":return"bg-green-100 text-green-800";case"긍정":return"bg-blue-100 text-blue-800";case"중립":return"bg-yellow-100 text-yellow-800";case"경계":return"bg-orange-100 text-orange-800";case"매도":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},C=()=>(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,t.jsx)("div",{className:"bg-blue-100 rounded-full p-3",children:(0,t.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCC8"})})}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-1",children:y.totalSignals.toLocaleString()}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"총 시그널 수"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,t.jsx)("div",{className:"bg-yellow-100 rounded-full p-3",children:(0,t.jsx)("span",{className:"text-2xl",children:"\uD83D\uDEA8"})})}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-1",children:y.totalReports.toLocaleString()}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"총 신고 수"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-yellow-400 rounded-full"}),(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"대기 중"})]}),(0,t.jsx)("p",{className:"text-3xl font-bold text-yellow-600 mb-1",children:y.pendingReports}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"검토 대기 신고"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}),(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"검토 중"})]}),(0,t.jsx)("p",{className:"text-3xl font-bold text-blue-600 mb-1",children:y.reviewedReports}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"검토 진행 신고"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-green-400 rounded-full"}),(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"처리 완료"})]}),(0,t.jsx)("p",{className:"text-3xl font-bold text-green-600 mb-1",children:y.resolvedReports}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"완료된 신고"})]})]})]}),q=()=>(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["신고 목록 (",o.length,"건)"]})}),0===o.length?(0,t.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[(0,t.jsx)("div",{className:"text-4xl mb-4",children:"\uD83D\uDCED"}),(0,t.jsx)("p",{children:"신고된 시그널이 없습니다."})]}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 table-fixed",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"80px"},children:"날짜"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"150px"},children:"시그널 내용"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"100px"},children:"신고 사유"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"200px"},children:"AI 검토 결과"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"200px"},children:"AI 수정안"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"70px"},children:"상태"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"100px"},children:"작업"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(e=>{var s,n,a,r,l,i,c,o;return(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:S(e.created_at)}),(0,t.jsx)("td",{className:"px-6 py-4",style:{minWidth:"120px",maxWidth:"180px"},children:(0,t.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"font-medium text-sm whitespace-nowrap",children:(null===(s=e.influencer_signals)||void 0===s?void 0:s.stock)||"Unknown"}),(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(E((null===(n=e.influencer_signals)||void 0===n?void 0:n.signal)||"")),children:(null===(a=e.influencer_signals)||void 0===a?void 0:a.signal)||"Unknown"})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:(null===(l=e.influencer_signals)||void 0===l?void 0:null===(r=l.speakers)||void 0===r?void 0:r.name)||(null===(o=e.influencer_signals)||void 0===o?void 0:null===(c=o.influencer_videos)||void 0===c?void 0:null===(i=c.influencer_channels)||void 0===i?void 0:i.channel_name)||"Unknown"})]})}),(0,t.jsxs)("td",{className:"px-6 py-4",children:[(0,t.jsx)("div",{className:"text-sm text-gray-900",children:e.reason}),e.detail&&(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-1 truncate max-w-xs",children:e.detail})]}),(0,t.jsx)("td",{className:"px-4 py-4",style:{maxWidth:"180px"},children:(0,t.jsx)("div",{className:"text-sm",children:e.ai_review?(()=>{let s=e.ai_review,n=/수정\s*필요|수정필요/i.test(s),a=/문제\s*없음|문제없음/i.test(s);if(n){let e=s.split("\n").filter(e=>e.trim()).find(e=>/근거|이유|문제점/.test(e)&&e.includes(":")),n="";if(e){let s=e.replace(/^[\s*#-]*.*?[:：]\s*/,"").replace(/\*+/g,"").slice(0,35);n=s?": ".concat(s).concat(s.length>=35?"...":""):""}return(0,t.jsxs)("span",{className:"text-amber-600",children:["⚠️ 수정필요",n]})}if(a)return(0,t.jsx)("span",{className:"text-green-600",children:"✅ 문제없음"});if("test"===s)return(0,t.jsx)("span",{className:"text-gray-400",children:"테스트"});{var r;if(!e.ai_suggestion)return(0,t.jsx)("span",{className:"text-green-600",children:"✅ 문제없음"});let n=(null===(r=s.split("\n").find(e=>e.trim()&&!e.startsWith("#")))||void 0===r?void 0:r.replace(/\*+/g,"").trim())||"검토완료";return(0,t.jsxs)("span",{className:"text-blue-600",children:["\uD83D\uDCCB ",n.slice(0,30),n.length>30?"...":""]})}})():(0,t.jsx)("span",{className:"text-yellow-600",children:"대기중"})})}),(0,t.jsx)("td",{className:"px-4 py-4",style:{maxWidth:"180px"},children:(0,t.jsx)("div",{className:"text-sm text-gray-600",children:e.ai_review&&(e.ai_review.includes("수정필요")||e.ai_review.includes("수정 필요"))?e.ai_suggestion?(0,t.jsx)("span",{className:"truncate block max-w-full",title:e.ai_suggestion,children:(()=>{try{let s=d(e.ai_suggestion),n=[],t=e.influencer_signals;return t&&s.stock&&s.stock!==t.stock&&n.push("종목: ".concat(t.stock,"→").concat(s.stock)),t&&s.signal&&s.signal!==t.signal&&n.push("신호: ".concat(t.signal,"→").concat(s.signal)),s.key_quote&&n.push("인용문 수정"),s.reasoning&&n.push("분석근거 수정"),n.length>0?n.slice(0,2).join(", "):"수정안 있음"}catch(e){return"수정안 있음"}})()}):(0,t.jsx)("span",{className:"text-yellow-600",children:"생성중..."}):(0,t.jsx)("span",{className:"text-gray-400",children:"-"})})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(I(e.status)),children:A(e.status)})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>g(e),className:"text-[#3182f6] hover:text-[#1b64da] transition-colors",children:"상세"}),(0,t.jsxs)("select",{value:e.status,onChange:s=>w(e.id,s.target.value),className:"text-xs border border-gray-300 rounded px-2 py-1",children:[(0,t.jsx)("option",{value:"pending",children:"대기"}),(0,t.jsx)("option",{value:"reviewed",children:"검토"}),(0,t.jsx)("option",{value:"resolved",children:"완료"})]})]})})]},e.id)})})]})})]})}),[O,R]=(0,a.useState)([]),[J,M]=(0,a.useState)(!1),[F,P]=(0,a.useState)({}),[B,T]=(0,a.useState)(new Set),[z,Q]=(0,a.useState)(null),[V,U]=(0,a.useState)(!1),[W,Y]=(0,a.useState)(""),[G,H]=(0,a.useState)(!1),X=async()=>{try{M(!0);let{data:e,error:s}=await r.OQ.from("influencer_signals").select("\n          id,\n          stock,\n          ticker,\n          signal,\n          key_quote,\n          reasoning,\n          confidence,\n          created_at,\n          influencer_videos (\n            title,\n            published_at,\n            video_id,\n            influencer_channels (\n              channel_name,\n              channel_handle\n            )\n          ),\n          speakers (\n            name\n          )\n        ").order("created_at",{ascending:!1}).limit(100);if(s)throw Error("시그널 데이터 조회 실패: "+s.message);let n=[];null==e||e.forEach(e=>{let s=[],t={};(!e.reasoning||e.reasoning.length<20)&&(s.push("분석근거 부족"),t["분석근거 부족"]=e.reasoning||"null"),(!e.key_quote||e.key_quote.length<15)&&(s.push("인용문 부족"),t["인용문 부족"]=e.key_quote||"null"),e.confidence||(s.push("신뢰도 누락"),t["신뢰도 누락"]="null"),s.length>0&&n.push({id:e.id,stock:e.stock,ticker:e.ticker,signal:e.signal,quote:e.key_quote,analysis_reasoning:e.reasoning,confidence:e.confidence,created_at:e.created_at,influencer_videos:e.influencer_videos,speakers:e.speakers,issueTypes:s,currentValues:t})}),R(n)}catch(e){console.error("품질 이슈 로딩 실패:",e),alert(e instanceof Error?e.message:"품질 이슈 로딩에 실패했습니다.")}finally{M(!1)}},Z=async()=>{try{U(!0);let{data:e,error:s}=await r.OQ.from("signal_reports").select("\n          id,\n          reason,\n          detail,\n          created_at,\n          status,\n          influencer_signals (\n            stock,\n            signal,\n            speakers (\n              name\n            ),\n            influencer_videos (\n              influencer_channels (\n                channel_name\n              )\n            )\n          )\n        ").order("created_at",{ascending:!1});if(s)throw Error("신고 데이터 조회 실패: "+s.message);let n={};null==e||e.forEach(e=>{n[e.reason]=(n[e.reason]||0)+1});let t={};null==e||e.forEach(e=>{var s;if(null===(s=e.influencer_signals)||void 0===s?void 0:s.signal){let s=e.influencer_signals.signal;t[s]=(t[s]||0)+1}});let a={};null==e||e.forEach(e=>{var s;if(null===(s=e.influencer_signals)||void 0===s?void 0:s.stock){let s=e.influencer_signals.stock;a[s]=(a[s]||0)+1}});let l={};null==e||e.forEach(e=>{var s,n,t,a,r;let i=(null===(n=e.influencer_signals)||void 0===n?void 0:null===(s=n.speakers)||void 0===s?void 0:s.name)||(null===(r=e.influencer_signals)||void 0===r?void 0:null===(a=r.influencer_videos)||void 0===a?void 0:null===(t=a.influencer_channels)||void 0===t?void 0:t.channel_name);i&&(l[i]=(l[i]||0)+1)});let i={};null==e||e.forEach(e=>{let s=new Date(e.created_at),n="".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0"));i[n]=(i[n]||0)+1});let c=Object.entries(n).sort((e,s)=>{let[,n]=e,[,t]=s;return t-n}).slice(0,10),d=Object.entries(t).sort((e,s)=>{let[,n]=e,[,t]=s;return t-n}).slice(0,10),o=Object.entries(a).sort((e,s)=>{let[,n]=e,[,t]=s;return t-n}).slice(0,10),x=Object.entries(l).sort((e,s)=>{let[,n]=e,[,t]=s;return t-n}).slice(0,10),m={totalReports:(null==e?void 0:e.length)||0,reasonStats:c.map(e=>{let[s,n]=e;return{reason:s,count:n}}),signalTypeStats:d.map(e=>{let[s,n]=e;return{signal:s,count:n}}),stockStats:o.map(e=>{let[s,n]=e;return{stock:s,count:n}}),speakerStats:x.map(e=>{let[s,n]=e;return{speaker:s,count:n}}),monthlyStats:Object.entries(i).sort((e,s)=>{let[n]=e,[t]=s;return n.localeCompare(t)}).map(e=>{let[s,n]=e;return{month:s,count:n}})};Q(m)}catch(e){console.error("신고 패턴 로딩 실패:",e),alert(e instanceof Error?e.message:"신고 패턴 로딩에 실패했습니다.")}finally{U(!1)}},L=async(e,s)=>{try{var n;T(s=>new Set(s).add(e));let{data:t,error:a}=await r.OQ.from("influencer_signals").select("\n          *,\n          influencer_videos (\n            subtitle_text,\n            title,\n            published_at\n          )\n        ").eq("id",e).single();if(a||!t)throw Error("시그널 데이터를 찾을 수 없습니다.");if(!(null===(n=t.influencer_videos)||void 0===n?void 0:n.subtitle_text))throw Error("자막 데이터가 없습니다.");let l=t.influencer_videos.subtitle_text,i=s.join(", "),d="\n품질 이슈가 발견된 시그널을 개선해 주세요.\n\n**원본 자막:**\n".concat(l,"\n\n**기존 시그널:**\n- 종목: ").concat(t.stock," (").concat(t.ticker||"N/A",")\n- 신호: ").concat(t.signal,"\n- 인용문: ").concat(t.key_quote||"null","\n- 타임스탬프: ").concat(t.timestamp||"N/A","\n- 분석근거: ").concat(t.reasoning||"null","\n- 신뢰도: ").concat(t.confidence||"null","\n\n**발견된 품질 이슈:**\n").concat(i,'\n\n**개선 지침:**\n1. 분석근거 부족: 자막을 바탕으로 최소 20자 이상의 구체적인 분석근거 작성\n2. 인용문 부족: 자막에서 정확한 핵심 발언을 15자 이상 인용\n3. 신뢰도 누락: 1-100 점수로 신뢰도 평가\n4. 시그널 타입은 반드시 한글 5단계만 사용: 매수/긍정/중립/경계/매도\n\n**개선안을 다음 JSON 형식으로 제공해 주세요:**\n{\n  "stock": "종목명",\n  "ticker": "티커 또는 null",\n  "signal": "매수|긍정|중립|경계|매도",\n  "key_quote": "원본 자막에서 추출한 실제 발언 (15자 이상, 반드시 자막 원문 그대로)",\n  "timestamp": "MM:SS (자막에서 해당 발언이 시작되는 시점)",\n  "reasoning": "자막 내용 기반 구체적 분석근거 (20자 이상)",\n  "confidence": 85\n}\n\n**절대 금지:** key_quote를 빈 문자열("")이나 "N/A"로 채우지 마세요. reasoning도 마찬가지. 반드시 원본 자막에서 실제 내용을 추출하세요.\n\n반드시 순수 JSON만 반환. markdown 코드블록(```)으로 감싸지 마세요.\n'),o=await c({model:"claude-sonnet-4-20250514",max_tokens:800,messages:[{role:"user",content:d}]}),x={success:!0,improvement:o,originalSignal:{stock:t.stock,ticker:t.ticker,signal:t.signal,quote:t.key_quote,timestamp:t.timestamp,analysis_reasoning:t.reasoning,confidence:t.confidence}};P(s=>({...s,[e]:x})),alert("AI 개선안이 생성되었습니다.")}catch(e){console.error("AI 개선 요청 실패:",e),alert(e instanceof Error?e.message:"개선안 생성 중 오류가 발생했습니다.")}finally{T(s=>{let n=new Set(s);return n.delete(e),n})}},K=async e=>{try{let s=F[e];if(!s)return;let n=d(s.improvement),{error:t}=await r.OQ.from("influencer_signals").update({stock:n.stock,ticker:n.ticker,signal:n.signal,key_quote:n.key_quote,timestamp:n.timestamp,reasoning:n.reasoning,confidence:n.confidence}).eq("id",e);if(t)throw t;alert("개선안이 승인되어 시그널이 업데이트되었습니다."),P(s=>{let n={...s};return delete n[e],n}),await X()}catch(e){console.error("개선안 승인 실패:",e),alert("개선안 승인에 실패했습니다.")}},$=e=>{P(s=>{let n={...s};return delete n[e],n})},ee=async()=>{try{if(H(!0),!z)throw Error("신고 패턴 데이터가 필요합니다.");let{data:e}=await r.OQ.from("signal_reports").select("reason, detail, ai_review, influencer_signals(stock, signal, key_quote)").not("ai_review","is",null).neq("ai_review","test").limit(10),s=(e||[]).map((e,s)=>{var n,t,a,r;return"   ".concat(s+1,". [").concat(e.reason,"] ").concat((null===(n=e.influencer_signals)||void 0===n?void 0:n.stock)||"?"," (").concat((null===(t=e.influencer_signals)||void 0===t?void 0:t.signal)||"?",") → AI판정: ").concat((null===(a=e.ai_review)||void 0===a?void 0:a.includes("수정필요"))||(null===(r=e.ai_review)||void 0===r?void 0:r.includes("수정 필요"))?"수정필요":"문제없음")}).join("\n"),n="\n신고 패턴 분석 결과와 AI 검토 결과를 바탕으로 파이프라인 프롬프트의 개선 규칙을 제안해 주세요.\n\n**현재 프롬프트 버전:** V10\n\n**신고 패턴 분석:**\n1. **사유별 신고 건수 TOP:**\n".concat(z.reasonStats.map(e=>"   - ".concat(e.reason,": ").concat(e.count,"건")).join("\n"),"\n\n2. **시그널 타입별 신고 빈도:**\n").concat(z.signalTypeStats.map(e=>"   - ".concat(e.signal,": ").concat(e.count,"건")).join("\n"),"\n\n3. **종목별 신고 빈도 TOP:**\n").concat(z.stockStats.map(e=>"   - ".concat(e.stock,": ").concat(e.count,"건")).join("\n"),"\n\n4. **화자별 신고 빈도 TOP:**\n").concat(z.speakerStats.map(e=>"   - ".concat(e.speaker,": ").concat(e.count,"건")).join("\n"),"\n\n5. **총 신고 건수:** ").concat(z.totalReports,"건\n\n6. **AI 검토 결과 요약:**\n").concat(s||"   (AI 검토 결과 없음)","\n\n**분석 기준:**\n- 자주 신고되는 사유를 줄이기 위한 추출 규칙 강화\n- 특정 시그널 타입의 오탐지 방지\n- 종목명/티커 정확도 향상\n- 인용문 및 분석근거의 품질 향상\n\n**개선안 형식:**\n다음과 같이 구체적인 규칙 5-7개를 제안해 주세요:\n\n1. [문제점] → [개선 규칙]\n2. [문제점] → [개선 규칙]\n...\n\n각 규칙은 구체적이고 실행 가능한 지침이어야 합니다.\n"),t=await c({model:"claude-sonnet-4-20250514",max_tokens:1500,messages:[{role:"user",content:n}]});Y(t)}catch(e){console.error("프롬프트 개선안 생성 실패:",e),alert(e instanceof Error?e.message:"프롬프트 개선안 생성 중 오류가 발생했습니다.")}finally{H(!1)}};(0,a.useEffect)(()=>{"ai-suggestions"===l&&0===O.length?X():"prompts"!==l||z||Z()},[l]);let es=()=>(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"\uD83E\uDD16 AI 품질 제안"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"품질 이슈가 감지된 시그널의 개선안을 확인합니다."})]}),(0,t.jsxs)("button",{onClick:X,disabled:J,className:"px-4 py-2 bg-[#3182f6] text-white rounded-lg hover:bg-[#1b64da] transition-colors flex items-center gap-2",children:[J?(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):"\uD83D\uDD04","품질 검사 실행"]})]}),J?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#3182f6] mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"품질 이슈를 분석하는 중..."})]}):0===O.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:"✅"}),(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"품질 이슈 없음"}),(0,t.jsx)("p",{className:"text-gray-600",children:"현재 품질 기준을 만족하지 않는 시그널이 없습니다."})]}):(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["품질 이슈 발견: ",O.length,"건"]})}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"시그널 정보"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"이슈 유형"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"현재값"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"작업"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:O.map(e=>{var s,n,a;return(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"font-medium text-sm",children:e.stock}),(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(E(e.signal)),children:e.signal})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:(null===(s=e.speakers)||void 0===s?void 0:s.name)||(null===(a=e.influencer_videos)||void 0===a?void 0:null===(n=a.influencer_channels)||void 0===n?void 0:n.channel_name)||"Unknown"}),(0,t.jsx)("div",{className:"text-xs text-gray-400",children:S(e.created_at)})]})}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsx)("div",{className:"space-y-1",children:e.issueTypes.map(e=>(0,t.jsx)("span",{className:"inline-block px-2 py-1 bg-red-100 text-red-800 text-xs rounded mr-1",children:e},e))})}),(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsx)("div",{className:"text-xs text-gray-600 space-y-1",children:Object.entries(e.currentValues).map(e=>{let[s,n]=e;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:"font-medium",children:[s,":"]}),(0,t.jsx)("span",{className:"ml-1 text-gray-500 truncate max-w-32 inline-block",children:String(n)})]},s)})})}),(0,t.jsx)("td",{className:"px-6 py-4",children:F[e.id]?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"text-xs text-green-600 font-medium",children:"✅ 개선안 생성됨"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>K(e.id),className:"px-3 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700",children:"승인"}),(0,t.jsx)("button",{onClick:()=>$(e.id),className:"px-3 py-1 bg-gray-300 text-gray-700 text-xs rounded hover:bg-gray-400",children:"거절"})]})]}):(0,t.jsx)("button",{onClick:()=>L(e.id,e.issueTypes),disabled:B.has(e.id),className:"px-3 py-1 bg-purple-600 text-white text-xs rounded hover:bg-purple-700 disabled:opacity-50 flex items-center gap-1",children:B.has(e.id)?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}),"처리중..."]}):(0,t.jsx)(t.Fragment,{children:"\uD83E\uDD16 AI 개선 요청"})})})]},e.id)})})]})}),Object.entries(F).length>0&&(0,t.jsxs)("div",{className:"px-6 py-4 border-t border-gray-200",children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"\uD83D\uDD27 AI 개선안 상세"}),(0,t.jsx)("div",{className:"space-y-6",children:Object.entries(F).map(e=>{let[s,n]=e;try{let e=d(n.improvement),a=n.originalSignal,r=O.find(e=>e.id===s);return(0,t.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("h5",{className:"font-medium text-gray-900",children:[null==r?void 0:r.stock," - ",null==r?void 0:r.signal]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>K(s),className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700",children:"✅ 승인"}),(0,t.jsx)("button",{onClick:()=>$(s),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:"❌ 거절"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"bg-red-50 rounded-lg p-3",children:[(0,t.jsx)("h6",{className:"font-medium text-red-800 mb-2",children:"\uD83D\uDCCB 원본"}),(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"종목:"})," ",a.stock]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"신호:"})," ",a.signal]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"인용문:"})," ",a.key_quote||"N/A"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"분석근거:"})," ",a.reasoning||"N/A"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"신뢰도:"})," ",a.confidence||"N/A"]})]})]}),(0,t.jsxs)("div",{className:"bg-green-50 rounded-lg p-3",children:[(0,t.jsx)("h6",{className:"font-medium text-green-800 mb-2",children:"✅ 개선안"}),(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"종목:"})," ",e.stock]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"신호:"})," ",e.signal]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"인용문:"})," ",e.key_quote]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"분석근거:"})," ",e.reasoning]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"신뢰도:"})," ",e.confidence]})]})]})]})]},s)}catch(e){return(0,t.jsx)("div",{className:"border rounded-lg p-4 bg-yellow-50",children:(0,t.jsx)("p",{className:"text-yellow-800",children:"개선안 파싱 오류"})},s)}})})]})]})]}),en=()=>{var e,s,n,a,r,l;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"⚙️ 프롬프트 관리"}),(0,t.jsx)("p",{className:"text-gray-600 mt-1",children:"신고 패턴을 분석하여 프롬프트 개선안을 제안합니다."})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full font-medium",children:"현재 버전: V10"}),(0,t.jsxs)("button",{onClick:Z,disabled:V,className:"px-4 py-2 bg-[#3182f6] text-white rounded-lg hover:bg-[#1b64da] transition-colors flex items-center gap-2",children:[V?(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):"\uD83D\uDCCA","패턴 분석"]})]})]}),V?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#3182f6] mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"신고 패턴을 분석하는 중..."})]}):z?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm border",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"총 신고 건수"}),(0,t.jsx)("p",{className:"text-3xl font-bold text-[#3182f6]",children:z.totalReports})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm border",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"주요 신고 사유"}),(0,t.jsx)("p",{className:"text-lg font-bold text-red-600",children:(null===(e=z.reasonStats[0])||void 0===e?void 0:e.reason)||"N/A"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[(null===(s=z.reasonStats[0])||void 0===s?void 0:s.count)||0,"건"]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm border",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"문제 신호 유형"}),(0,t.jsx)("p",{className:"text-lg font-bold text-orange-600",children:(null===(n=z.signalTypeStats[0])||void 0===n?void 0:n.signal)||"N/A"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[(null===(a=z.signalTypeStats[0])||void 0===a?void 0:a.count)||0,"건"]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-4 shadow-sm border",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"문제 종목"}),(0,t.jsx)("p",{className:"text-lg font-bold text-purple-600",children:(null===(r=z.stockStats[0])||void 0===r?void 0:r.stock)||"N/A"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[(null===(l=z.stockStats[0])||void 0===l?void 0:l.count)||0,"건"]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm border",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"\uD83D\uDCCB 사유별 신고 현황"}),(0,t.jsx)("div",{className:"space-y-3",children:z.reasonStats.slice(0,5).map(e=>(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-700",children:e.reason}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-sm font-bold",children:[e.count,"건"]}),(0,t.jsx)("div",{className:"w-20 h-2 bg-gray-200 rounded-full",children:(0,t.jsx)("div",{className:"h-2 bg-red-500 rounded-full",style:{width:"".concat(e.count/z.totalReports*100,"%")}})})]})]},e.reason))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm border",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"\uD83C\uDFAF 시그널 타입별 신고"}),(0,t.jsx)("div",{className:"space-y-3",children:z.signalTypeStats.slice(0,5).map(e=>(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(E(e.signal)),children:e.signal}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-sm font-bold",children:[e.count,"건"]}),(0,t.jsx)("div",{className:"w-20 h-2 bg-gray-200 rounded-full",children:(0,t.jsx)("div",{className:"h-2 bg-orange-500 rounded-full",style:{width:"".concat(e.count/z.totalReports*100,"%")}})})]})]},e.signal))})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-sm border",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"\uD83D\uDE80 프롬프트 개선안 생성"}),(0,t.jsx)("button",{onClick:ee,disabled:G,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:G?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"AI 분석 중..."]}):(0,t.jsx)(t.Fragment,{children:"\uD83E\uDD16 개선안 생성"})})]}),W?(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("h4",{className:"font-medium text-green-800",children:"AI 생성 프롬프트 개선 규칙"}),(0,t.jsx)("button",{onClick:()=>navigator.clipboard.writeText(W),className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700",children:"\uD83D\uDCCB 복사"})]}),(0,t.jsx)("div",{className:"text-sm text-green-700 whitespace-pre-wrap bg-white rounded border p-3",children:W})]})}):(0,t.jsx)("p",{className:"text-gray-500 text-sm",children:"신고 패턴 분석 결과를 바탕으로 파이프라인 프롬프트의 개선 규칙을 AI가 생성합니다."})]})]}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCCA"}),(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"패턴 분석 대기"}),(0,t.jsx)("p",{className:"text-gray-600",children:"신고 패턴 분석 버튼을 클릭하여 시작하세요."})]})]})};return m?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#3182f6] mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"데이터를 불러오는 중..."})]})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"관리자 대시보드"}),(0,t.jsx)("p",{className:"text-gray-600",children:"시그널 신고 및 시스템을 관리합니다."})]}),(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsx)("div",{className:"border-b border-gray-200",children:(0,t.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"dashboard",label:"\uD83D\uDCCA 대시보드",icon:"\uD83D\uDCCA"},{id:"reports",label:"\uD83D\uDEA8 신고 관리",icon:"\uD83D\uDEA8"},{id:"ai-suggestions",label:"\uD83E\uDD16 AI 제안",icon:"\uD83E\uDD16"},{id:"prompts",label:"⚙️ 프롬프트 관리",icon:"⚙️"}].map(e=>(0,t.jsx)("button",{onClick:()=>i(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm transition-colors ".concat(l===e.id?"border-[#3182f6] text-[#3182f6]":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:e.label},e.id))})})}),(()=>{switch(l){case"dashboard":default:return C();case"reports":return q();case"ai-suggestions":return es();case"prompts":return en()}})()]}),h&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"신고 상세 정보"}),(0,t.jsx)("button",{onClick:()=>g(null),className:"text-gray-400 hover:text-gray-600 text-2xl",children:"\xd7"})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"신고 정보"}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"신고 일시:"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:S(h.created_at)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"신고 사유:"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:h.reason})]}),h.detail&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"상세 내용:"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:h.detail})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"처리 상태:"}),(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(I(h.status)),children:A(h.status)})]})]})]}),h.influencer_signals&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"시그널 정보"}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("span",{className:"font-medium",children:h.influencer_signals.stock}),(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(E(h.influencer_signals.signal)),children:h.influencer_signals.signal})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"핵심 발언:"}),(0,t.jsxs)("div",{className:"text-sm bg-white p-3 rounded border italic",children:['"',h.influencer_signals.key_quote,'"']})]}),h.influencer_signals.reasoning&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"분석 내용:"}),(0,t.jsx)("div",{className:"text-sm bg-white p-3 rounded border whitespace-pre-wrap",children:h.influencer_signals.reasoning})]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["발언자: ",(null===(e=h.influencer_signals.speakers)||void 0===e?void 0:e.name)||(null===(n=h.influencer_signals.influencer_videos)||void 0===n?void 0:null===(s=n.influencer_channels)||void 0===s?void 0:s.channel_name)||"Unknown"]}),h.influencer_signals.influencer_videos&&(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["영상: ",h.influencer_signals.influencer_videos.title]})]})]}),h.ai_review&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"\uD83E\uDD16 AI 검토 결과"}),(0,t.jsx)("div",{className:"bg-blue-50 rounded-lg p-4",children:(0,t.jsx)("div",{className:"text-sm whitespace-pre-wrap",children:h.ai_review})})]}),h.ai_suggestion&&h.influencer_signals&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"\uD83D\uDD27 AI 수정안"}),(0,t.jsx)("div",{className:"space-y-4",children:(()=>{try{let e=d(h.ai_suggestion),s=h.influencer_signals;return(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"bg-red-50 rounded-lg p-4",children:[(0,t.jsx)("h5",{className:"font-medium text-red-800 mb-2",children:"\uD83D\uDCCB 원본 시그널"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"종목:"})," ",s.stock]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"티커:"})," ",s.ticker||"N/A"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"신호:"})," ",s.signal]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"인용문:"}),' "',s.key_quote,'"']}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"타임스탬프:"})," ",s.timestamp]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"분석근거:"})," ",s.reasoning||"N/A"]})]})]}),(0,t.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,t.jsx)("h5",{className:"font-medium text-green-800 mb-2",children:"✅ AI 수정안"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"종목:"})," ",e.stock]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"티커:"})," ",e.ticker||"N/A"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"신호:"})," ",e.signal]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"인용문:"}),' "',e.key_quote,'"']}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"타임스탬프:"})," ",e.timestamp]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:"분석근거:"})," ",e.reasoning||"N/A"]})]})]})]})}catch(e){return(0,t.jsxs)("div",{className:"bg-yellow-50 rounded-lg p-4",children:[(0,t.jsx)("p",{className:"text-yellow-800 text-sm",children:"AI 수정안 파싱 오류"}),(0,t.jsx)("pre",{className:"text-xs mt-2 overflow-x-auto",children:h.ai_suggestion})]})}})()})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,t.jsx)("button",{onClick:()=>g(null),className:"px-4 py-2 text-sm text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"닫기"}),!h.ai_review&&(0,t.jsx)("button",{onClick:()=>_(h.id),disabled:p&&j===h.id,className:"px-4 py-2 text-sm text-white bg-purple-600 rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:p&&j===h.id?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"AI 검토 중..."]}):(0,t.jsx)(t.Fragment,{children:"\uD83E\uDD16 AI 검토 요청"})}),h.ai_suggestion&&(0,t.jsx)("button",{onClick:()=>k(h),className:"px-4 py-2 text-sm text-white bg-green-600 rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:"✅ 수정안 승인"}),(0,t.jsx)("button",{onClick:()=>D(h.id),className:"px-4 py-2 text-sm text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:"❌ 신고 거절"})]})]})]})})})]})}},2141:function(e,s,n){"use strict";n.d(s,{Be:function(){return o},OQ:function(){return t},Y9:function(){return u},getSignalVoteCounts:function(){return x},getStockSignals:function(){return l},hv:function(){return m},kB:function(){return a},l2:function(){return r},oP:function(){return d},pC:function(){return i},to:function(){return c}});let t=(0,n(3053).eI)("https://arypzhotxflimroprmdk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFyeXB6aG90eGZsaW1yb3BybWRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwMDYxMTAsImV4cCI6MjA4NzU4MjExMH0.qcqFIvYRiixwu609Wjj9H3HxscU8vNpo9nS_KQ3f00A");async function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;try{let{data:s,error:n}=await t.from("influencer_signals").select("\n        *,\n        influencer_videos (\n          title,\n          published_at,\n          video_id,\n          video_summary,\n          channel_id,\n          influencer_channels (\n            channel_name,\n            channel_handle\n          )\n        ),\n        speakers (\n          name\n        )\n      ").order("created_at",{ascending:!1}).limit(e);if(n)return console.error("Error fetching latest signals:",n),[];return s||[]}catch(e){return console.error("Error in getLatestInfluencerSignals:",e),[]}}async function r(e){try{let{data:s,error:n}=await t.from("influencer_signals").select("\n        *,\n        influencer_videos (\n          title,\n          published_at,\n          video_id,\n          influencer_channels (\n            channel_name,\n            channel_handle\n          )\n        ),\n        speakers (\n          name\n        )\n      ").eq("speaker_id",e).order("created_at",{ascending:!1});if(!s||0===s.length){let{data:a}=await t.from("speakers").select("id").eq("name",e);if(a&&a.length>0){let e=a.map(e=>e.id),{data:r,error:l}=await t.from("influencer_signals").select("\n            *,\n            influencer_videos (\n              title,\n              published_at,\n              video_id,\n              influencer_channels (\n                channel_name,\n                channel_handle\n              )\n            ),\n            speakers (\n              name\n            )\n          ").in("speaker_id",e).order("created_at",{ascending:!1});l||(s=r,n=l)}}if(n)return console.error("Error fetching speaker signals:",n),null;return{speakerName:e,signals:s||[],totalSignals:(null==s?void 0:s.length)||0,stocks:[...new Set(null==s?void 0:s.map(e=>e.stock).filter(Boolean))],channels:[...new Set(null==s?void 0:s.map(e=>{var s,n;return null===(n=e.influencer_videos)||void 0===n?void 0:null===(s=n.influencer_channels)||void 0===s?void 0:s.channel_name}).filter(Boolean))]}}catch(e){return console.error("Error in getInfluencerProfileBySpeaker:",e),null}}async function l(e){try{let s={"005930":"삼성전자","000660":"SK하이닉스","035420":"NAVER","051910":"LG화학","005380":"현대차","086520":"에코프로","009540":"한국가스공사",399720:"퓨처켐",298040:"효성중공업","036930":"주성엔지니어링","042700":"한미반도체","095610":"테스","000720":"현대건설","004170":"신세계","006400":"삼성SDI",267260:"HD현대일렉트릭","090430":"아모레퍼시픽","036570":"NC소프트",207940:"삼성바이오로직스","079160":"CGV",403870:"HPSP",240810:"원익IPS"}[e],n=t.from("influencer_signals").select("\n        *,\n        influencer_videos (\n          title,\n          published_at,\n          video_id,\n          video_summary,\n          channel_id,\n          influencer_channels (\n            channel_name,\n            channel_handle\n          )\n        ),\n        speakers (\n          name\n        )\n      ");n=s?n.or("ticker.eq.".concat(e,",stock.eq.").concat(s)):n.eq("ticker",e);let{data:a,error:r}=await n.order("created_at",{ascending:!1});if(r)return console.error("Error fetching stock signals:",r),[];return a||[]}catch(e){return console.error("Error in getStockSignals:",e),[]}}async function i(e,s,n){try{let{data:a,error:r}=await t.from("signal_reports").insert({signal_id:e,reason:s,detail:n||null}).select().single();if(r)throw console.error("Error inserting signal report:",r),r;return a}catch(e){throw console.error("Error in insertSignalReport:",e),e}}async function c(){try{let{data:e,error:s}=await t.from("signal_reports").select("\n        *,\n        influencer_signals (\n          id,\n          stock,\n          ticker,\n          signal,\n          key_quote,\n          reasoning,\n          influencer_videos (\n            title,\n            published_at,\n            video_id,\n            influencer_channels (\n              channel_name,\n              channel_handle\n            )\n          ),\n          speakers (\n            name\n          )\n        )\n      ").order("created_at",{ascending:!1});if(s)return console.error("Error fetching signal reports:",s),[];return e||[]}catch(e){return console.error("Error in getSignalReports:",e),[]}}async function d(e,s){try{let{data:n,error:a}=await t.from("signal_reports").update({status:s}).eq("id",e).select().single();if(a)throw console.error("Error updating report status:",a),a;return n}catch(e){throw console.error("Error in updateReportStatus:",e),e}}async function o(e,s){try{let{data:n,error:a}=await t.from("signal_votes").insert({signal_id:e,vote_type:"like",memo:s}).select().single();if(a)throw console.error("Error inserting signal vote:",a),a;return n}catch(e){throw console.error("Error in insertSignalVote:",e),e}}async function x(e){try{if(!e.length)return{};let{data:s,error:n}=await t.from("signal_votes").select("signal_id").in("signal_id",e);if(n)return console.error("Error fetching signal vote counts:",n),{};let a={};return null==s||s.forEach(e=>{a[e.signal_id]=(a[e.signal_id]||0)+1}),a}catch(e){return console.error("Error in getSignalVoteCounts:",e),{}}}async function m(e,s,n){try{let{data:a,error:r}=await t.from("signal_memos").insert({signal_id:e,memo:s,user_id:n||null}).select().single();if(r)throw console.error("Error inserting signal memo:",r),r;return a}catch(e){throw console.error("Error in insertSignalMemo:",e),e}}async function u(){try{let e=async(e,s)=>{try{let n=t.from(e).select("*",{count:"exact",head:!0});s&&(n=n.eq(s.col,s.val));let{count:a,error:r}=await n;if(r)return console.warn("Count error for ".concat(e,":"),r.message),0;return a||0}catch(e){return 0}},[s,n,a,r]=await Promise.all([e("influencer_signals"),e("signal_votes"),e("signal_reports"),e("signal_memos")]),[l,i,c]=await Promise.all([e("signal_reports",{col:"status",val:"pending"}),e("signal_reports",{col:"status",val:"reviewed"}),e("signal_reports",{col:"status",val:"resolved"})]);return{totalSignals:s,totalVotes:n,totalReports:a,totalMemos:r,pendingReports:l,reviewedReports:i,resolvedReports:c,participationRate:s>0?Math.round((n+a+r)/s*100):0}}catch(e){return console.error("Error in getAdminStats:",e),{totalSignals:0,totalVotes:0,totalReports:0,totalMemos:0,pendingReports:0,reviewedReports:0,resolvedReports:0,participationRate:0}}}}},function(e){e.O(0,[53,971,117,744],function(){return e(e.s=1690)}),_N_E=e.O()}]);