"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{5798:function(e,n,t){t.d(n,{Z:function(){return i}});var r=t(7437),l=t(2265),s=t(2141);let a=[/confidence\s*[=:]\s*\w+/gi,/mention_type\s*[=:]\s*\w+/gi,/signal_type\s*[=:]\s*\w+/gi,/\[내부\s*메모\]/gi,/\[AI\s*(분석|메모|노트)\]/gi];function i(e){var n;let t;let{signal:i,onClose:c}=e,[o,d]=(0,l.useState)(!1),[u,f]=(0,l.useState)(""),[x,m]=(0,l.useState)(!1),[h,g]=(0,l.useState)((null==i?void 0:i.likeCount)||0),[p,b]=(0,l.useState)(!1),[v,y]=(0,l.useState)(""),[_,j]=(0,l.useState)(""),[N,w]=(0,l.useState)(!1);if(!i)return null;let k=e=>{if(!e)return null;let n=e.split(":").map(Number);return 2===n.length?60*n[0]+n[1]:3===n.length?3600*n[0]+60*n[1]+n[2]:null},S=!i.channelName||!i.influencer||i.channelName===i.influencer||i.channelName.includes(i.influencer)||i.influencer.includes(i.channelName),C=async()=>{if(!(null==i?void 0:i.id)){alert("시그널 ID가 없습니다.");return}if(x){m(!1),d(!1);return}try{await (0,s.Be)(i.id),m(!0),g(e=>e+1),d(!0)}catch(e){console.error("좋아요 처리 중 오류:",e),alert("좋아요 처리에 실패했습니다.")}},I=async()=>{if(!(null==i?void 0:i.id)||!u.trim()){alert("메모 내용을 입력해주세요.");return}try{await (0,s.hv)(i.id,u.trim()),alert("저장되었습니다"),d(!1),f("")}catch(e){console.error("메모 저장 중 오류:",e),alert("메모 저장에 실패했습니다.")}},E=async()=>{if(!(null==i?void 0:i.id)||!v){alert("신고 사유를 선택해주세요.");return}if("기타"===v&&!_.trim()){alert("기타 사유를 입력해주세요.");return}w(!0);try{await (0,s.pC)(i.id,v,"기타"===v?_:void 0),alert("신고가 접수되었습니다."),b(!1),y(""),j("")}catch(e){console.error("신고 처리 중 오류:",e),alert("신고 접수에 실패했습니다. 다시 시도해주세요.")}finally{w(!1)}},D=(()=>{if(!i.videoUrl||"#"===i.videoUrl)return null;let e=k(i.timestamp);if(e&&i.videoUrl.includes("youtube.com")||i.videoUrl.includes("youtu.be")){let n=i.videoUrl.includes("?")?"&":"?";return"".concat(i.videoUrl).concat(n,"t=").concat(e)}return i.videoUrl})();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:c}),(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onClick:c,children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[85vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"sticky top-0 bg-white z-10 px-4 pt-4 pb-2 flex items-center justify-between rounded-t-2xl",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"px-2.5 py-1 rounded-full text-xs font-bold ".concat((e=>{switch(e){case"매수":return"text-green-600 bg-green-50";case"긍정":return"text-blue-600 bg-blue-50";case"중립":return"text-yellow-600 bg-yellow-50";case"경계":return"text-orange-600 bg-orange-50";case"매도":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}})(i.signal)),children:i.signal}),h>0&&(0,r.jsxs)("span",{className:"text-xs text-[#8b95a1]",children:["❤️ ",h]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{onClick:C,className:"transition-colors text-sm px-2 py-1 rounded-lg ".concat(x?"text-red-500":"text-[#8b95a1] hover:text-red-400"),children:x?"❤️":"\uD83E\uDD0D"}),(0,r.jsx)("button",{onClick:()=>{if(!(null==i?void 0:i.id)){alert("시그널 ID가 없습니다.");return}b(!0)},className:"text-[#8b95a1] hover:text-red-500 transition-colors text-sm px-2 py-1 rounded-lg",children:"\uD83D\uDEA8"}),(0,r.jsx)("button",{onClick:c,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-[#f8f9fa] transition-colors text-[#8b95a1] text-lg",children:"✕"})]})]}),(0,r.jsxs)("div",{className:"px-5 pb-5 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-[#191f28] leading-snug",children:i.videoTitle||(null===(n=i.quote)||void 0===n?void 0:n.slice(0,40))+"..."}),(0,r.jsx)("p",{className:"text-sm text-[#8b95a1] mt-1",children:(e=>{try{return new Date(e).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch(n){return e}})(i.date)})]}),(0,r.jsx)("div",{className:"text-sm text-[#8b95a1]",children:S?(0,r.jsxs)(r.Fragment,{children:["채널: ",(0,r.jsx)("span",{className:"font-medium text-[#191f28]",children:i.influencer})]}):(0,r.jsxs)(r.Fragment,{children:["발언자: ",(0,r.jsx)("span",{className:"font-medium text-[#191f28]",children:i.influencer})]})}),(0,r.jsxs)("div",{className:"bg-[#f8f9fa] rounded-xl p-4 border-l-4 border-[#3182f6]",children:[(0,r.jsx)("div",{className:"text-xs font-medium text-[#8b95a1] mb-2",children:"핵심발언"}),(0,r.jsxs)("p",{className:"text-[15px] text-[#191f28] leading-relaxed italic",children:["“",i.quote,"”"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-medium text-[#8b95a1] mb-2",children:"내용요약"}),i.analysis_reasoning?(0,r.jsx)("p",{className:"text-sm text-[#333d4b] leading-relaxed whitespace-pre-wrap",children:(t=i.analysis_reasoning,a.forEach(e=>{t=t.replace(e,"").trim()}),t=t.replace(/\n{3,}/g,"\n\n").trim())}):(0,r.jsx)("p",{className:"text-sm text-[#8b95a1] italic",children:"영상 요약 준비 중"})]}),o&&(0,r.jsxs)("div",{className:"bg-[#fffbeb] rounded-xl p-4 border border-[#fde68a]",children:[(0,r.jsx)("div",{className:"text-xs font-medium text-[#92400e] mb-2",children:"\uD83D\uDC9B 메모 남기기"}),(0,r.jsx)("textarea",{value:u,onChange:e=>f(e.target.value),placeholder:"이 시그널에 대한 메모를 남겨보세요...",className:"w-full text-sm border border-[#fde68a] rounded-lg p-2 resize-none h-20 focus:outline-none focus:ring-1 focus:ring-[#f59e0b]"}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,r.jsx)("button",{onClick:()=>d(!1),className:"text-xs text-[#8b95a1] px-3 py-1.5 rounded-lg hover:bg-[#f8f9fa]",children:"취소"}),(0,r.jsx)("button",{onClick:I,className:"text-xs text-white bg-[#f59e0b] px-3 py-1.5 rounded-lg hover:bg-[#d97706] font-medium",children:"저장"})]})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[i.ticker&&(0,r.jsx)("a",{href:"/invest-sns/stock/".concat(i.ticker,"?tab=influencer"),className:"flex-1 text-center bg-[#3182f6] hover:bg-[#1b64da] text-white font-medium py-3.5 rounded-xl transition-colors text-[15px]",children:"\uD83D\uDCCA 차트보기"}),D&&(0,r.jsx)("a",{href:D,target:"_blank",rel:"noopener noreferrer",className:"flex-1 text-center bg-[#ff0000] hover:bg-[#cc0000] text-white font-medium py-3.5 rounded-xl transition-colors text-[15px]",children:"▶️ 영상보기"})]}),p&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50 rounded-2xl flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl p-5 w-full max-w-sm",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-[#191f28] mb-4",children:"시그널 신고"}),(0,r.jsx)("div",{className:"space-y-3 mb-4",children:["시그널 틀림","종목 오류","발언 왜곡","기타"].map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:"reportReason",value:e,checked:v===e,onChange:e=>y(e.target.value),className:"w-4 h-4 text-[#3182f6]"}),(0,r.jsx)("span",{className:"text-sm text-[#191f28]",children:e})]},e))}),"기타"===v&&(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("textarea",{value:_,onChange:e=>j(e.target.value),placeholder:"신고 사유를 상세히 입력해주세요...",className:"w-full border border-gray-300 rounded-lg p-3 text-sm resize-none h-20 focus:outline-none focus:ring-2 focus:ring-[#3182f6]"})}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>{b(!1),y(""),j("")},className:"flex-1 py-2.5 text-sm text-[#8b95a1] bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"취소"}),(0,r.jsx)("button",{onClick:E,disabled:N||!v,className:"flex-1 py-2.5 text-sm text-white bg-[#3182f6] rounded-lg hover:bg-[#1b64da] disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:N?"처리 중...":"신고"})]})]})})]})]})})]})}},2141:function(e,n,t){t.d(n,{Be:function(){return d},OQ:function(){return r},getStockSignals:function(){return a},hv:function(){return u},kB:function(){return l},l2:function(){return s},oP:function(){return o},pC:function(){return i},to:function(){return c}});let r=(0,t(3053).eI)("https://arypzhotxflimroprmdk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFyeXB6aG90eGZsaW1yb3BybWRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwMDYxMTAsImV4cCI6MjA4NzU4MjExMH0.qcqFIvYRiixwu609Wjj9H3HxscU8vNpo9nS_KQ3f00A");async function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;try{let{data:n,error:t}=await r.from("influencer_signals").select("\n        *,\n        influencer_videos (\n          title,\n          published_at,\n          video_id,\n          video_summary,\n          channel_id,\n          influencer_channels (\n            channel_name,\n            channel_handle\n          )\n        ),\n        speakers (\n          name\n        )\n      ").order("created_at",{ascending:!1}).limit(e);if(t)return console.error("Error fetching latest signals:",t),[];return n||[]}catch(e){return console.error("Error in getLatestInfluencerSignals:",e),[]}}async function s(e){try{let{data:n,error:t}=await r.from("influencer_signals").select("\n        *,\n        influencer_videos (\n          title,\n          published_at,\n          video_id,\n          influencer_channels (\n            channel_name,\n            channel_handle\n          )\n        ),\n        speakers (\n          name\n        )\n      ").eq("speaker_id",e).order("created_at",{ascending:!1});if(!n||0===n.length){let{data:l}=await r.from("speakers").select("id").eq("name",e);if(l&&l.length>0){let e=l.map(e=>e.id),{data:s,error:a}=await r.from("influencer_signals").select("\n            *,\n            influencer_videos (\n              title,\n              published_at,\n              video_id,\n              influencer_channels (\n                channel_name,\n                channel_handle\n              )\n            ),\n            speakers (\n              name\n            )\n          ").in("speaker_id",e).order("created_at",{ascending:!1});a||(n=s,t=a)}}if(t)return console.error("Error fetching speaker signals:",t),null;return{speakerName:e,signals:n||[],totalSignals:(null==n?void 0:n.length)||0,stocks:[...new Set(null==n?void 0:n.map(e=>e.stock).filter(Boolean))],channels:[...new Set(null==n?void 0:n.map(e=>{var n,t;return null===(t=e.influencer_videos)||void 0===t?void 0:null===(n=t.influencer_channels)||void 0===n?void 0:n.channel_name}).filter(Boolean))]}}catch(e){return console.error("Error in getInfluencerProfileBySpeaker:",e),null}}async function a(e){try{let n={"005930":"삼성전자","000660":"SK하이닉스","035420":"NAVER","051910":"LG화학","005380":"현대차","086520":"에코프로","009540":"한국가스공사",399720:"퓨처켐",298040:"효성중공업","036930":"주성엔지니어링","042700":"한미반도체","095610":"테스","000720":"현대건설","004170":"신세계","006400":"삼성SDI",267260:"HD현대일렉트릭","090430":"아모레퍼시픽","036570":"NC소프트",207940:"삼성바이오로직스","079160":"CGV",403870:"HPSP",240810:"원익IPS"}[e],t=r.from("influencer_signals").select("\n        *,\n        influencer_videos (\n          title,\n          published_at,\n          video_id,\n          video_summary,\n          channel_id,\n          influencer_channels (\n            channel_name,\n            channel_handle\n          )\n        ),\n        speakers (\n          name\n        )\n      ");t=n?t.or("ticker.eq.".concat(e,",stock.eq.").concat(n)):t.eq("ticker",e);let{data:l,error:s}=await t.order("created_at",{ascending:!1});if(s)return console.error("Error fetching stock signals:",s),[];return l||[]}catch(e){return console.error("Error in getStockSignals:",e),[]}}async function i(e,n,t){try{let{data:l,error:s}=await r.from("signal_reports").insert({signal_id:e,reason:n,detail:t||null}).select().single();if(s)throw console.error("Error inserting signal report:",s),s;return l}catch(e){throw console.error("Error in insertSignalReport:",e),e}}async function c(){try{let{data:e,error:n}=await r.from("signal_reports").select("\n        *,\n        influencer_signals (\n          id,\n          stock,\n          ticker,\n          signal,\n          quote,\n          analysis_reasoning,\n          influencer_videos (\n            title,\n            published_at,\n            video_id,\n            influencer_channels (\n              channel_name,\n              channel_handle\n            )\n          ),\n          speakers (\n            name\n          )\n        )\n      ").order("created_at",{ascending:!1});if(n)return console.error("Error fetching signal reports:",n),[];return e||[]}catch(e){return console.error("Error in getSignalReports:",e),[]}}async function o(e,n){try{let{data:t,error:l}=await r.from("signal_reports").update({status:n}).eq("id",e).select().single();if(l)throw console.error("Error updating report status:",l),l;return t}catch(e){throw console.error("Error in updateReportStatus:",e),e}}async function d(e,n){try{let{data:t,error:l}=await r.from("signal_votes").insert({signal_id:e,vote_type:"like",memo:n}).select().single();if(l)throw console.error("Error inserting signal vote:",l),l;return t}catch(e){throw console.error("Error in insertSignalVote:",e),e}}async function u(e,n,t){try{let{data:l,error:s}=await r.from("signal_memos").insert({signal_id:e,memo:n,user_id:t||null}).select().single();if(s)throw console.error("Error inserting signal memo:",s),s;return l}catch(e){throw console.error("Error in insertSignalMemo:",e),e}}}}]);