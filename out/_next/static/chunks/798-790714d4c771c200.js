"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{5798:function(e,n,t){t.d(n,{Z:function(){return c}});var r=t(7437),a=t(29),s=t.n(a),l=t(2265),i=t(2141);let o=[/confidence\s*[=:]\s*\w+/gi,/mention_type\s*[=:]\s*\w+/gi,/signal_type\s*[=:]\s*\w+/gi,/\[내부\s*메모\]/gi,/\[AI\s*(분석|메모|노트)\]/gi];function c(e){var n;let t;let{signal:a,onClose:c}=e,[d,u]=(0,l.useState)(!1),[f,m]=(0,l.useState)(""),[x,h]=(0,l.useState)(!1),[g,p]=(0,l.useState)((null==a?void 0:a.likeCount)||0),[b,y]=(0,l.useState)(!1),[v,_]=(0,l.useState)(""),[j,w]=(0,l.useState)(""),[k,N]=(0,l.useState)(!1);if(!a)return null;let S=e=>{if(!e)return null;let n=e.split(":").map(Number);return 2===n.length?60*n[0]+n[1]:3===n.length?3600*n[0]+60*n[1]+n[2]:null},I=!a.channelName||!a.influencer||a.channelName===a.influencer||a.channelName.includes(a.influencer)||a.influencer.includes(a.channelName),C=async()=>{if(!(null==a?void 0:a.id)){alert("시그널 ID가 없습니다.");return}if(x){h(!1),u(!1);return}try{await (0,i.Be)(a.id),h(!0),p(e=>e+1),u(!0)}catch(e){console.error("좋아요 처리 중 오류:",e),alert("좋아요 처리에 실패했습니다.")}},E=async()=>{if(!(null==a?void 0:a.id)||!f.trim()){alert("메모 내용을 입력해주세요.");return}try{await (0,i.hv)(a.id,f.trim()),alert("저장되었습니다"),u(!1),m("")}catch(e){console.error("메모 저장 중 오류:",e),alert("메모 저장에 실패했습니다.")}},R=async()=>{if(!(null==a?void 0:a.id)||!v){alert("신고 사유를 선택해주세요.");return}if(j.trim().length<10){alert("상세 사유를 최소 10자 이상 입력해주세요.");return}N(!0);try{await (0,i.pC)(a.id,v,j.trim()),alert("신고가 접수되었습니다."),y(!1),_(""),w("")}catch(e){console.error("신고 처리 중 오류:",e),alert("신고 접수에 실패했습니다. 다시 시도해주세요.")}finally{N(!1)}},z=(()=>{if(!a.videoUrl||"#"===a.videoUrl)return null;let e=S(a.timestamp);if(e&&a.videoUrl.includes("youtube.com")||a.videoUrl.includes("youtu.be")){let n=a.videoUrl.includes("?")?"&":"?";return"".concat(a.videoUrl).concat(n,"t=").concat(e)}return a.videoUrl})();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:c}),(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",onClick:c,children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[85vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"sticky top-0 bg-white z-10 px-4 pt-4 pb-2 flex items-center justify-between rounded-t-2xl",children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)("span",{className:"px-2.5 py-1 rounded-full text-xs font-bold ".concat((e=>{switch(e){case"매수":return"text-green-600 bg-green-50";case"긍정":return"text-blue-600 bg-blue-50";case"중립":return"text-yellow-600 bg-yellow-50";case"경계":return"text-orange-600 bg-orange-50";case"매도":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}})(a.signal)),children:a.signal})}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsxs)("button",{onClick:C,className:"transition-colors text-lg px-3 py-2 rounded-lg flex items-center gap-1 border-none outline-none ".concat(x?"text-red-500":"text-[#8b95a1] hover:text-red-400"),children:[x?"❤️":"♡",g>0&&(0,r.jsx)("span",{className:"text-sm",children:g})]}),(0,r.jsx)("button",{onClick:()=>{if(!(null==a?void 0:a.id)){alert("시그널 ID가 없습니다.");return}y(!0)},className:"text-[#8b95a1] hover:text-red-500 transition-colors text-sm px-2 py-1 rounded-lg",children:"\uD83D\uDEA8"}),(0,r.jsx)("button",{onClick:c,className:"w-8 h-8 flex items-center justify-center rounded-full hover:bg-[#f8f9fa] transition-colors text-[#8b95a1] text-lg",children:"✕"})]})]}),(0,r.jsxs)("div",{className:"px-5 pb-5 space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-[#191f28] leading-snug",children:a.videoTitle||(null===(n=a.quote)||void 0===n?void 0:n.slice(0,40))+"..."}),(0,r.jsx)("p",{className:"text-sm text-[#8b95a1] mt-1",children:(e=>{try{return new Date(e).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}catch(n){return e}})(a.date)})]}),(0,r.jsx)("div",{className:"text-sm text-[#8b95a1]",children:I?(0,r.jsxs)(r.Fragment,{children:["채널: ",(0,r.jsx)("span",{className:"font-medium text-[#191f28]",children:a.influencer})]}):(0,r.jsxs)(r.Fragment,{children:["발언자: ",(0,r.jsx)("span",{className:"font-medium text-[#191f28]",children:a.influencer})]})}),(0,r.jsxs)("div",{className:"bg-[#f8f9fa] rounded-xl p-4 border-l-4 border-[#3182f6]",children:[(0,r.jsx)("div",{className:"text-xs font-medium text-[#8b95a1] mb-2",children:"핵심발언"}),(0,r.jsxs)("p",{className:"text-[15px] text-[#191f28] leading-relaxed italic",children:["“",a.quote,"”"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-medium text-[#8b95a1] mb-2",children:"내용요약"}),a.analysis_reasoning?(0,r.jsx)("p",{className:"text-sm text-[#333d4b] leading-relaxed whitespace-pre-wrap",children:(t=a.analysis_reasoning,o.forEach(e=>{t=t.replace(e,"").trim()}),t=t.replace(/\n{3,}/g,"\n\n").trim())}):(0,r.jsx)("p",{className:"text-sm text-[#8b95a1] italic",children:"이 영상은 요약이 제공되지 않습니다"})]}),d&&(0,r.jsxs)("div",{className:"bg-[#fffbeb] rounded-xl p-4 border border-[#fde68a]",children:[(0,r.jsx)("div",{className:"text-xs font-medium text-[#92400e] mb-2",children:"\uD83D\uDC9B 메모 남기기"}),(0,r.jsx)("textarea",{value:f,onChange:e=>m(e.target.value),placeholder:"이 시그널에 대한 메모를 남겨보세요...",className:"w-full text-sm border border-[#fde68a] rounded-lg p-2 resize-none h-20 focus:outline-none focus:ring-1 focus:ring-[#f59e0b]"}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,r.jsx)("button",{onClick:()=>u(!1),className:"text-xs text-[#8b95a1] px-3 py-1.5 rounded-lg hover:bg-[#f8f9fa]",children:"취소"}),(0,r.jsx)("button",{onClick:E,className:"text-xs text-white bg-[#f59e0b] px-3 py-1.5 rounded-lg hover:bg-[#d97706] font-medium",children:"저장"})]})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[a.ticker&&(0,r.jsx)("a",{href:"/invest-sns/stock/".concat(a.ticker,"?tab=influencer"),className:"flex-1 text-center bg-[#3182f6] hover:bg-[#1b64da] text-white font-medium py-3.5 rounded-xl transition-colors text-[15px]",children:"\uD83D\uDCCA 차트보기"}),z&&(0,r.jsx)("a",{href:z,target:"_blank",rel:"noopener noreferrer",className:"flex-1 text-center bg-[#ff0000] hover:bg-[#cc0000] text-white font-medium py-3.5 rounded-xl transition-colors text-[15px]",children:"▶️ 영상보기"})]}),b&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50 rounded-2xl flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"jsx-df7c63da77218bbf bg-white rounded-xl p-5 w-full max-w-sm",children:[(0,r.jsx)("h3",{className:"jsx-df7c63da77218bbf text-lg font-bold text-[#191f28] mb-4",children:"시그널 신고"}),(0,r.jsx)("div",{className:"jsx-df7c63da77218bbf space-y-3 mb-4",children:["시그널 틀림","종목 오류","발언 왜곡","기타"].map(e=>(0,r.jsxs)("label",{className:"jsx-df7c63da77218bbf flex items-center gap-3 cursor-pointer",children:[(0,r.jsx)("input",{type:"radio",name:"reportReason",value:e,checked:v===e,onChange:e=>{_(e.target.value),w("")},className:"jsx-df7c63da77218bbf w-4 h-4 text-[#3182f6]"}),(0,r.jsx)("span",{className:"jsx-df7c63da77218bbf text-sm text-[#191f28]",children:e})]},e))}),v&&(0,r.jsxs)("div",{style:{animation:"fadeIn 0.2s ease-in"},className:"jsx-df7c63da77218bbf mb-4",children:[(0,r.jsx)("textarea",{value:j,onChange:e=>w(e.target.value),placeholder:"상세 사유를 입력해주세요",style:{padding:"8px",fontSize:"14px",lineHeight:"1.5"},rows:4,className:"jsx-df7c63da77218bbf w-full border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-[#3182f6]"}),j.length>0&&j.length<10&&(0,r.jsxs)("p",{style:{color:"#ef4444"},className:"jsx-df7c63da77218bbf text-xs mt-1",children:["최소 10자 이상 입력해주세요 (",j.length,"/10)"]})]}),(0,r.jsx)(s(),{id:"df7c63da77218bbf",children:"@-webkit-keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(-4px);transform:translatey(-4px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fadeIn{from{opacity:0;-moz-transform:translatey(-4px);transform:translatey(-4px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fadeIn{from{opacity:0;-o-transform:translatey(-4px);transform:translatey(-4px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fadeIn{from{opacity:0;-webkit-transform:translatey(-4px);-moz-transform:translatey(-4px);-o-transform:translatey(-4px);transform:translatey(-4px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}"}),(0,r.jsxs)("div",{className:"jsx-df7c63da77218bbf flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>{y(!1),_(""),w("")},className:"jsx-df7c63da77218bbf flex-1 py-2.5 text-sm text-[#8b95a1] bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"취소"}),(0,r.jsx)("button",{onClick:R,disabled:k||!v||j.length<10,className:"jsx-df7c63da77218bbf flex-1 py-2.5 text-sm text-white bg-[#3182f6] rounded-lg hover:bg-[#1b64da] disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:k?"처리 중...":"신고"})]})]})})]})]})})]})}},2141:function(e,n,t){t.d(n,{Be:function(){return d},OQ:function(){return r},Y9:function(){return m},getSignalVoteCounts:function(){return u},getStockSignals:function(){return l},hv:function(){return f},kB:function(){return a},l2:function(){return s},oP:function(){return c},pC:function(){return i},to:function(){return o}});let r=(0,t(3053).eI)("https://arypzhotxflimroprmdk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFyeXB6aG90eGZsaW1yb3BybWRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIwMDYxMTAsImV4cCI6MjA4NzU4MjExMH0.qcqFIvYRiixwu609Wjj9H3HxscU8vNpo9nS_KQ3f00A");async function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;try{let{data:n,error:t}=await r.from("influencer_signals").select("\n        *,\n        influencer_videos (\n          title,\n          published_at,\n          video_id,\n          video_summary,\n          channel_id,\n          influencer_channels (\n            channel_name,\n            channel_handle\n          )\n        ),\n        speakers (\n          name\n        )\n      ").order("created_at",{ascending:!1}).limit(e);if(t)return console.error("Error fetching latest signals:",t),[];return n||[]}catch(e){return console.error("Error in getLatestInfluencerSignals:",e),[]}}async function s(e){try{let{data:n,error:t}=await r.from("influencer_signals").select("\n        *,\n        influencer_videos (\n          title,\n          published_at,\n          video_id,\n          influencer_channels (\n            channel_name,\n            channel_handle\n          )\n        ),\n        speakers (\n          name\n        )\n      ").eq("speaker_id",e).order("created_at",{ascending:!1});if(!n||0===n.length){let{data:a}=await r.from("speakers").select("id").eq("name",e);if(a&&a.length>0){let e=a.map(e=>e.id),{data:s,error:l}=await r.from("influencer_signals").select("\n            *,\n            influencer_videos (\n              title,\n              published_at,\n              video_id,\n              influencer_channels (\n                channel_name,\n                channel_handle\n              )\n            ),\n            speakers (\n              name\n            )\n          ").in("speaker_id",e).order("created_at",{ascending:!1});l||(n=s,t=l)}}if(t)return console.error("Error fetching speaker signals:",t),null;return{speakerName:e,signals:n||[],totalSignals:(null==n?void 0:n.length)||0,stocks:[...new Set(null==n?void 0:n.map(e=>e.stock).filter(Boolean))],channels:[...new Set(null==n?void 0:n.map(e=>{var n,t;return null===(t=e.influencer_videos)||void 0===t?void 0:null===(n=t.influencer_channels)||void 0===n?void 0:n.channel_name}).filter(Boolean))]}}catch(e){return console.error("Error in getInfluencerProfileBySpeaker:",e),null}}async function l(e){try{let n={"005930":"삼성전자","000660":"SK하이닉스","035420":"NAVER","051910":"LG화학","005380":"현대차","086520":"에코프로","009540":"한국가스공사",399720:"퓨처켐",298040:"효성중공업","036930":"주성엔지니어링","042700":"한미반도체","095610":"테스","000720":"현대건설","004170":"신세계","006400":"삼성SDI",267260:"HD현대일렉트릭","090430":"아모레퍼시픽","036570":"NC소프트",207940:"삼성바이오로직스","079160":"CGV",403870:"HPSP",240810:"원익IPS"}[e],t=r.from("influencer_signals").select("\n        *,\n        influencer_videos (\n          title,\n          published_at,\n          video_id,\n          video_summary,\n          channel_id,\n          influencer_channels (\n            channel_name,\n            channel_handle\n          )\n        ),\n        speakers (\n          name\n        )\n      ");t=n?t.or("ticker.eq.".concat(e,",stock.eq.").concat(n)):t.eq("ticker",e);let{data:a,error:s}=await t.order("created_at",{ascending:!1});if(s)return console.error("Error fetching stock signals:",s),[];return a||[]}catch(e){return console.error("Error in getStockSignals:",e),[]}}async function i(e,n,t){try{let{data:a,error:s}=await r.from("signal_reports").insert({signal_id:e,reason:n,detail:t||null}).select().single();if(s)throw console.error("Error inserting signal report:",s),s;return a}catch(e){throw console.error("Error in insertSignalReport:",e),e}}async function o(){try{let{data:e,error:n}=await r.from("signal_reports").select("\n        *,\n        influencer_signals (\n          id,\n          stock,\n          ticker,\n          signal,\n          key_quote,\n          reasoning,\n          influencer_videos (\n            title,\n            published_at,\n            video_id,\n            influencer_channels (\n              channel_name,\n              channel_handle\n            )\n          ),\n          speakers (\n            name\n          )\n        )\n      ").order("created_at",{ascending:!1});if(n)return console.error("Error fetching signal reports:",n),[];return e||[]}catch(e){return console.error("Error in getSignalReports:",e),[]}}async function c(e,n){try{let{data:t,error:a}=await r.from("signal_reports").update({status:n}).eq("id",e).select().single();if(a)throw console.error("Error updating report status:",a),a;return t}catch(e){throw console.error("Error in updateReportStatus:",e),e}}async function d(e,n){try{let{data:t,error:a}=await r.from("signal_votes").insert({signal_id:e,vote_type:"like",memo:n}).select().single();if(a)throw console.error("Error inserting signal vote:",a),a;return t}catch(e){throw console.error("Error in insertSignalVote:",e),e}}async function u(e){try{if(!e.length)return{};let{data:n,error:t}=await r.from("signal_votes").select("signal_id").in("signal_id",e);if(t)return console.error("Error fetching signal vote counts:",t),{};let a={};return null==n||n.forEach(e=>{a[e.signal_id]=(a[e.signal_id]||0)+1}),a}catch(e){return console.error("Error in getSignalVoteCounts:",e),{}}}async function f(e,n,t){try{let{data:a,error:s}=await r.from("signal_memos").insert({signal_id:e,memo:n,user_id:t||null}).select().single();if(s)throw console.error("Error inserting signal memo:",s),s;return a}catch(e){throw console.error("Error in insertSignalMemo:",e),e}}async function m(){try{let[e,n,t]=await Promise.all([r.from("influencer_signals").select("id",{count:"exact",head:!0}),r.from("signal_votes").select("id",{count:"exact",head:!0}).catch(()=>({count:0})),r.from("signal_reports").select("id",{count:"exact",head:!0}).catch(()=>({count:0}))]),[a,s,l]=await Promise.all([r.from("signal_reports").select("id",{count:"exact",head:!0}).eq("status","pending").catch(()=>({count:0})),r.from("signal_reports").select("id",{count:"exact",head:!0}).eq("status","reviewed").catch(()=>({count:0})),r.from("signal_reports").select("id",{count:"exact",head:!0}).eq("status","resolved").catch(()=>({count:0}))]),i=e.count||0,o=n.count||0,c=t.count||0,d=(await r.from("signal_memos").select("id",{count:"exact",head:!0}).catch(()=>({count:0}))).count||0;return{totalSignals:i,totalVotes:o,totalReports:c,totalMemos:d,pendingReports:a.count||0,reviewedReports:s.count||0,resolvedReports:l.count||0,participationRate:i>0?Math.round((o+c+d)/i*100):0}}catch(e){return console.error("Error in getAdminStats:",e),{totalSignals:0,totalVotes:0,totalReports:0,totalMemos:0,pendingReports:0,reviewedReports:0,resolvedReports:0,participationRate:0}}}}}]);